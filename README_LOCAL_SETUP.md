# 🏗️ تطبيق دراسة الجدوى العقارية المتقدم
## دليل التشغيل المحلي (Local Setup Guide)

### 📦 النسخة الاحتياطية
**🔗 رابط التحميل:** https://page.gensparksite.com/project_backups/tooluse_vWUqZ0bpSEax6xK1ZNL11Q.tar.gz
**📊 حجم الملف:** 426KB
**📅 تاريخ الإنشاء:** 22 سبتمبر 2025

---

## 🚀 خطوات التشغيل المحلي

### 1. تحميل واستخراج المشروع
```bash
# تحميل النسخة الاحتياطية
wget https://page.gensparksite.com/project_backups/tooluse_vWUqZ0bpSEax6xK1ZNL11Q.tar.gz

# استخراج الملفات
tar -xzf tooluse_vWUqZ0bpSEax6xK1ZNL11Q.tar.gz

# الانتقال لمجلد المشروع
cd home/user/webapp
```

### 2. تثبيت المتطلبات الأساسية
```bash
# التأكد من وجود Node.js (إصدار 18 أو أحدث)
node --version
npm --version

# إذا لم يكن Node.js مثبتاً، قم بتثبيته من:
# https://nodejs.org/
```

### 3. تثبيت التبعيات
```bash
# تثبيت جميع التبعيات
npm install

# أو باستخدام yarn
yarn install
```

### 4. تشغيل المشروع محلياً
```bash
# طريقة 1: تشغيل خادم التطوير (مُوصى به للتطوير المحلي)
npm run dev

# طريقة 2: بناء المشروع ثم تشغيله
npm run build
npm run preview

# طريقة 3: استخدام wrangler للتشغيل المحلي (مثل Cloudflare Pages)
npx wrangler pages dev dist --port 3000
```

### 5. الوصول للتطبيق
```
🌐 المتصفح: http://localhost:3000
📱 للوصول من أجهزة أخرى في الشبكة المحلية: http://[your-ip]:3000
```

---

## 📋 معلومات المشروع

### 🛠️ التقنيات المستخدمة
- **Backend Framework:** Hono (لـ Cloudflare Workers/Pages)
- **Frontend:** Vanilla JavaScript + TailwindCSS
- **Build Tool:** Vite
- **Deployment Platform:** Cloudflare Pages
- **Language Support:** عربي/إنجليزي مع RTL/LTR

### 🎯 الميزات الرئيسية
- ✅ **نظام إدارة الاستخدامات المحسن** - إدارة الوحدات الفرعية لكل استخدام
- ✅ **نظام إدارة التكاليف المتقدم** - تكاليف تطوير مفصلة حسب نوع الاستخدام
- ✅ **نظام إدارة الإيرادات الذكي** - إيرادات مفصلة على مستوى الوحدات الفرعية
- ✅ **حسابات ديناميكية** - تحديث تلقائي للمساحات والوحدات والتكاليف
- ✅ **واجهة ثنائية اللغة** - عربي وإنجليزي مع دعم كامل لـ RTL
- ✅ **تصدير التقارير** - PDF للتقرير الكامل والملخص التنفيذي
- ✅ **رسوم بيانية تفاعلية** - Chart.js للمخططات والتحليلات

### 📊 أقسام النظام

#### 1. 🏗️ نظام إدارة الاستخدامات
- **الأنواع الرئيسية:** تجاري، فندق، سكني، مكاتب
- **الوحدات الفرعية:** كل استخدام يحتوي على وحدات فرعية متعددة
- **الحسابات:** مساحة كل وحدة × عدد الوحدات = المساحة الإجمالية
- **المرونة:** إضافة/حذف الوحدات الفرعية ديناميكياً

#### 2. 💰 نظام إدارة التكاليف  
- **تكاليف التطوير:** هيكل إنشائي، تشطيبات، أثاث، أنظمة، سلامة
- **الأتعاب المهنية:** تصميم، هندسة، إدارة مشروع، إشراف، تراخيص
- **رسوم التطوير:** ربح مطور، تسويق، رسوم قانونية، تأمين، تمويل
- **الطوارئ والمخاطر:** طوارئ تنفيذ، تضخم، تأخير، متطلبات تنظيمية

#### 3. 💰 نظام إدارة الإيرادات
- **إيرادات الإيجار:** حساب على مستوى الوحدة الفرعية مع نسب الإشغال
- **إيرادات المبيعات:** أسعار البيع مع نسب البيع المتوقعة  
- **الإيرادات الإضافية:** مواقف، إعلانات، إدارة، مرافق، فعاليات
- **تحسين الإيرادات:** استراتيجيات تحسين مع تأثير مئوي

---

## 📝 Scripts متاحة

```json
{
  "dev": "vite",
  "build": "vite build", 
  "preview": "wrangler pages dev dist",
  "deploy": "npm run build && wrangler pages deploy dist"
}
```

### 🔧 Scripts إضافية للتطوير المحلي
```bash
# تنظيف وإعادة البناء
npm run build

# تشغيل خادم محلي سريع
python -m http.server 8000 --directory dist

# أو باستخدام serve (إذا كان مثبتاً)
npx serve dist -p 3000
```

---

## 🗂️ هيكل المشروع
```
webapp/
├── src/
│   └── index.tsx          # تطبيق Hono الرئيسي
├── public/
│   └── static/
│       └── app.js         # JavaScript الرئيسي
├── dist/                  # ملفات البناء (auto-generated)
├── package.json           # تبعيات ومعرفات المشروع
├── vite.config.ts         # إعدادات Vite
├── wrangler.toml          # إعدادات Cloudflare (للنشر)
├── ecosystem.config.cjs   # إعدادات PM2 
└── README.md              # دليل المشروع
```

---

## 🔧 استكشاف الأخطاء وإصلاحها

### مشكلة: الخادم لا يبدأ
```bash
# تحقق من أن المنفذ 3000 غير مستخدم
netstat -an | grep 3000

# أو استخدم منفذ مختلف
npm run dev -- --port 3001
```

### مشكلة: التبعيات لا تثبت بشكل صحيح
```bash
# مسح ذاكرة التخزين المؤقت وإعادة التثبيت
rm -rf node_modules package-lock.json
npm cache clean --force
npm install
```

### مشكلة: ملفات JavaScript لا تعمل
```bash
# تأكد من بناء المشروع أولاً
npm run build

# ثم تشغيل الخادم
npm run preview
```

---

## 🚀 للنشر على Cloudflare Pages

### 1. إعداد Wrangler
```bash
# تثبيت Wrangler CLI
npm install -g wrangler

# تسجيل الدخول
wrangler login
```

### 2. إنشاء مشروع Cloudflare Pages
```bash
# إنشاء مشروع جديد
wrangler pages project create my-feasibility-app --production-branch main

# نشر المشروع
npm run build
wrangler pages deploy dist --project-name my-feasibility-app
```

---

## 📞 الدعم والمساعدة

### 🐛 الإبلاغ عن خطأ
إذا واجهت أي مشاكل، تأكد من:
1. إصدار Node.js 18+ 
2. تثبيت التبعيات بنجاح (`npm install`)
3. بناء المشروع (`npm run build`)
4. التحقق من سجلات وحدة التحكم في المتصفح

### 🔄 التحديثات المستقبلية
هذا المشروع جاهز للتطوير والتحسين. يمكنك:
- إضافة أنواع استخدامات جديدة
- تخصيص حسابات التكاليف والإيرادات  
- إضافة تكاملات قواعد بيانات
- تحسين الواجهة والتصميم

---

## 📄 الترخيص
هذا المشروع مطور خصيصاً لدراسة الجدوى العقارية وهو مفتوح المصدر للاستخدام والتطوير.

---

## 🏆 الميزات المُحدثة (آخر إصدار)

### ✅ تم إصلاح مؤخراً:
- **مشكلة عرض تفاصيل الإيرادات**: النظام الآن يعرض جميع حقول الإدخال للوحدات الفرعية
- **حسابات المساحات**: تم إصلاح حساب المساحة الإجمالية للوحدات الفرعية
- **التزامن بين الأنظمة**: تحديث تلقائي للإيرادات عند تغيير بيانات الاستخدامات
- **أخطاء JavaScript**: إزالة الكود المكرر وإصلاح جميع الأخطاء البرمجية

### 🎯 جاهز للاستخدام الفوري:
- تشغيل محلي بدون إعدادات معقدة
- واجهة مستخدم كاملة ومتجاوبة
- حسابات دقيقة ومتقدمة
- تصدير تقارير PDF
- دعم كامل للغة العربية

**🎉 المشروع جاهز 100% للاستخدام المحلي والنشر!**